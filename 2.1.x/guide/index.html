<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>Micronaut Picocli Configuration</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/custom.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <link rel="stylesheet" href="../css/highlight/agate.css">
    <script src="../js/highlight.pack.js"></script>
    <script src="../js/guide.js"></script>
    <script src="../js/multi-language-sample.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="../css/multi-language-sample.css"/>
    <script src="../js/docs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
    <script type="text/javascript">
        function addJsClass(el) {
            var classes = document.body.className.split(" ");
            classes.push("js");
            document.body.className = classes.join(" ");
        }
    </script>

</head>

<body class="body" id="docs" onload="addJsClass();" onhashchange="highlightMenu()">

<div id="table-of-content-nav-link" class="desktop">
    <a title="Collapse/Open Table of contents" title="Hide Table of Contents" href="javascript:hideTableOfContents();" class="button">[ + ]</a>
</div>

<div id="main">
    <div id="navigation" class="no-print">
        <div class="navTitle">
            <span id="logo"><a href="http://micronaut.io" title="Go to Micronaut Website"><img src="../img/micronaut-logo-white.svg" alt="Micronaut"/></a></span>
        </div>
        <div class="navLinks">
            <ul>
                    <li>
                        <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)" class="desktop">
                            <a href="../guide/index.html" class="button">Table of contents</a>
                            <div id="nav-summary-childs" style="display:none;">
                                
                                <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#setup"><strong>2</strong><span>Setting up Picocli</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#generate"><strong>3</strong><span>Generating a Picocli Project</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#quickstart"><strong>4</strong><span>Picocli Quick Start</span></a></div>
                                
                            </div>
                        </div>
                    </li>

                <li id="table-of-content-nav-link-mobile" class="mobile">
                    <a title="Scroll to Table of contents" href="javascript:scrollToTop();" class="button">Toc</a>
                </li>
                <li class="desktop">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API</a>
                </li>
                <li class="desktop">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Configuration Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Conf</a>
                </li>
            </ul>

        </div>
    </div>
    
    <div id="table-of-content">
        <div class="toc-content">

        <h2>Table of Contents</h2>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-introduction"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-setup"><a href="#setup"><strong>2</strong><span>Setting up Picocli</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-generate"><a href="#generate"><strong>3</strong><span>Generating a Picocli Project</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-quickstart"><a href="#quickstart"><strong>4</strong><span>Picocli Quick Start</span></a></div>
        
        </div>
    </div>
    
    <div class="docs-content">
    <div class="project">
        <h1>Micronaut Picocli Configuration</h1>
        <p></p>
        <p>Provides integration between Micronaut and Picocli</p>
        <p><strong>Version:</strong> <select style='max-width: 200px' onChange='window.document.location.href=this.options[this.selectedIndex].value;'><option value='https://micronaut-projects.github.io/micronaut-picocli/snapshot/guide/index.html'>SNAPSHOT</option><option selected='selected' value='https://micronaut-projects.github.io/micronaut-picocli/2.1.0/guide/index.html'>2.1.0</option><option value='https://micronaut-projects.github.io/micronaut-picocli/2.0.0/guide/index.html'>2.0.0</option><option value='https://micronaut-projects.github.io/micronaut-picocli/1.2.1/guide/index.html'>1.2.1</option><option value='https://micronaut-projects.github.io/micronaut-picocli/1.2.0/guide/index.html'>1.2.0</option></select></p>
    </div>
    

<h1 id="introduction">1 Introduction</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-picocli/edit/master/src/main/docs/guide/introduction.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="https://github.com/remkop/picocli">Picocli</a> is a command line parser that supports usage help with ANSI colors, autocomplete and nested subcommands. It has an annotations API to create command line applications with almost no code, and a programmatic API for dynamic uses like creating Domain Specific Languages.</p>
</div>
<div class="paragraph">
<p>From the project Readme page:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>How it works: annotate your class and picocli initializes it from the command line arguments,
converting the input to strongly typed data. Supports git-like <a href="http://picocli.info/#_subcommands">subcommands</a>
(and nested <a href="http://picocli.info/#_nested_sub_subcommands">sub-subcommands</a>),
any option prefix style, POSIX-style <a href="http://picocli.info/#_short_options">grouped short options</a>,
<a href="http://picocli.info/#_interactive_password_options">password options</a>,
custom <a href="http://picocli.info/#_custom_type_converters">type converters</a> and more.
Parser <a href="http://picocli.info/#_tracing">tracing</a> facilitates troubleshooting.</p>
</div>
<div class="paragraph">
<p>It distinguishes between <a href="http://picocli.info/#_options">named options</a> and
<a href="http://picocli.info/#_positional_parameters">positional parameters</a> and allows both to be
<a href="http://picocli.info/#_strongly_typed_everything">strongly typed</a>.
<a href="http://picocli.info/#_multiple_values">Multi-valued fields</a> can specify
an exact number of parameters or a <a href="http://picocli.info/#_arity">range</a> (e.g., <code>0..*</code>, <code>1..2</code>).
Supports <a href="http://picocli.info/#_maps">Map options</a> like <code>-Dkey1=val1 -Dkey2=val2</code>, where both key and value can be strongly typed.</p>
</div>
<div class="paragraph">
<p>It generates polished and easily tailored <a href="http://picocli.info/#_usage_help">usage help</a>
and  <a href="http://picocli.info/#_version_help">version help</a>,
using <a href="http://picocli.info/#_ansi_colors_and_styles">ANSI colors</a> where possible.
Picocli-based command line applications can have <a href="http://picocli.info/autocomplete.html">TAB autocompletion</a>,
interactively showing users what options and subcommands are available.
Picocli can generate completion scripts for bash and zsh, and offers an API to easily create a <a href="https://github.com/jline/jline2">JLine</a> <code>Completer</code> for your application.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Micronaut features dedicated support for defining picocli <code>Command</code> instances. Micronaut applications built with picocli can be deployed with or without the presence of an HTTP server.</p>
</div>
<div class="paragraph">
<p>Combining picocli with Micronaut makes it easy to provide a rich, well-documented command line interface for your Microservices.</p>
</div>
<div class="sect2">
<h3 id="_release_history">Release History</h3>
<div class="sect3">
<h4 id="_2_0_0">2.0.0</h4>
<div class="ulist">
<ul>
<li>
<p>Micronaut 1.3.4 minimum version</p>
</li>
<li>
<p>Changed Maven group to <code>io.micronaut.picocli</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_1_0_0">1.0.0</h4>
<div class="ulist">
<ul>
<li>
<p>Initial Release</p>
</li>
</ul>
</div>
</div>
</div>


<h1 id="setup">2 Setting up Picocli</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-picocli/edit/master/src/main/docs/guide/setup.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Using the CLI</div>
<div class="paragraph">
<p>If you are creating your project using the Micronaut CLI, supply the <code>picocli</code> feature to configure Picocli in your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mn create-app my-app --features picocli</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To add support for Picocli to an existing project, you should first add the picocli dependency and the Micronaut picocli configuration to your build configuration.</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"info.picocli:picocli")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;info.picocli&lt;/groupId&gt;
    &lt;artifactId&gt;picocli&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.picocli:micronaut-picocli:2.1.0")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.picocli&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-picocli&lt;/artifactId&gt;
    &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</p>
</div>
<div class="sect2">
<h3 id="_configuring_picocli">Configuring picocli</h3>
<div class="paragraph">
<p>Picocli does not require configuration. See other sections of the manual for configuring the services and resources to inject.</p>
</div>
</div>


<h1 id="generate">3 Generating a Picocli Project</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-picocli/edit/master/src/main/docs/guide/generate.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To create a project with picocli support using the Micronaut CLI, use the <code>create-cli-app</code> command.
This will add the dependencies for the <code>picocli</code> feature, and set the profile of the generated project to <code>cli</code>, so the <code>create-command</code> command is available to generate additional commands.</p>
</div>
<div class="paragraph">
<p>The main class of the project is set to the <code>*Command</code> class (based on the project name - e.g., <code>hello-world</code> will generate <code>HelloWorldCommand</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mn create-cli-app my-cli-app</pre>
</div>
</div>
<div class="paragraph">
<p>The generated command looks like this:</p>
</div>
<div class="listingblock">
<div class="title">my.cli.app.MyCliAppCommand.java generated by <code>create-cli-app</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package my.cli.app;

import io.micronaut.configuration.picocli.PicocliRunner;
import io.micronaut.context.ApplicationContext;

import picocli.CommandLine;
import picocli.CommandLine.Command;
import picocli.CommandLine.Option;
import picocli.CommandLine.Parameters;

@Command(name = "my-cli-app", description = "...",
        mixinStandardHelpOptions = true) <i class="conum" data-value="1"></i><b>(1)</b>
public class MyCliAppCommand implements Runnable { <i class="conum" data-value="2"></i><b>(2)</b>

    @Option(names = {"-v", "--verbose"}, description = "...") <i class="conum" data-value="3"></i><b>(3)</b>
    boolean verbose;

    public static void main(String[] args) throws Exception {
        PicocliRunner.run(MyCliAppCommand.class, args); <i class="conum" data-value="4"></i><b>(4)</b>
    }

    public void run() { <i class="conum" data-value="5"></i><b>(5)</b>
        // business logic here
        if (verbose) {
            System.out.println("Hi!");
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The picocli <a href="https://picocli.info/apidocs/picocli/CommandLine.Command.html">@Command</a> annotation designates this class as a command. The <code>mixinStandardHelpOptions</code> attribute adds <code>--help</code> and <code>--version</code> options to it.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>By implementing <code>Runnable</code> or <code>Callable</code> your application can be executed in a single line (&lt;4&gt;) and picocli takes care of handling invalid input and requests for usage help (<code>&lt;cmd&gt; --help</code>) or version information (<code>&lt;cmd&gt; --version</code>).</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>An example option. Options can have any name and be of <a href="https://picocli.info/#_strongly_typed_everything">any type</a>. The generated code contains this example boolean flag option that lets the user request more verbose output.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>PicocliRunner</code> lets picocli-based applications leverage the Micronaut DI container. <code>PicocliRunner.run</code> first creates an instance of this command with all services and resources injected, then parses the command line, while taking care of handling invalid input and requests for usage help or version information, and finally invokes the <code>run</code> method.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Put the business logic of the application in the <code>run</code> or <code>call</code> method.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_running_the_application">Running the Application</h3>
<div class="paragraph">
<p>Now you can build the project and start the application. The build will create a <code>${project-name}-all.jar</code> with all dependencies in <code>build/libs</code>.
Running this jar from Java will run the generated <code>MyCliAppCommand</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar build/libs/my-cli-app-0.1-all.jar -v</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_picocli_feature">Picocli Feature</h3>
<div class="paragraph">
<p>Alternatively, to create a project with picocli support using the Micronaut CLI, supply the <code>picocli</code> feature to the <code>features</code> flag.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mn create-app my-picocli-app --features picocli</pre>
</div>
</div>
<div class="paragraph">
<p>This will create a project with the <code>service</code> profile that has the minimum necessary configuration for picocli.</p>
</div>
<div class="paragraph">
<p>Note that no command is generated and the main class of the project is set to the default <code>Application</code> class.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cli_profile">Cli Profile</h3>
<div class="paragraph">
<p>It is also possible to create a project with the <code>create-app</code> command and the <code>--profile=cli</code> flag.
This will create a Micronaut app with picocli support, without an HTTP server (although you can add one if you desire).
The <code>cli</code> profile provides a command for generating picocli commands and subcommands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mn create-app example --profile cli</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the main class of the project is set to the default <code>Application</code> class.</p>
</div>
<div class="paragraph">
<p>If you want a picocli command to be the main class of this application, you need to first generate a command with <code>create-command</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd example
$ ../mn
mn&gt; create-command example.my-command
| Rendered template Command.java to destination src/main/java/example/MyCommand.java
| Rendered template CommandTest.java to destination src/test/java/example/MyCommandTest.java</pre>
</div>
</div>
<div class="paragraph">
<p>Then open the <code>gradle.build</code> file, and change the <code>mainClassName</code> line to the fully qualified class name of the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mainClassName = "example.MyCommand"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>create-cli-app</code> command is more convenient, since it generates a project that includes a command from the beginning and sets the main class to this command.
</td>
</tr>
</table>
</div>
</div>


<h1 id="quickstart">4 Picocli Quick Start</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-picocli/edit/master/src/main/docs/guide/quickstart.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect2">
<h3 id="_creating_a_picocli_command_with_command">Creating a Picocli Command with @Command</h3>
<div class="paragraph">
<p>This section will show a quick example that provides a command line interface to a HTTP client that communicates with the GitHub API.</p>
</div>
<div class="paragraph">
<p>When creating this example project with the Micronaut CLI, use the <code>create-cli-app</code> command, and add the <code>--features=http-client</code> flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mn create-cli-app example.git-star --features http-client</pre>
</div>
</div>
<div class="paragraph">
<p>This will add the <code>io.micronaut:micronaut-http-client</code> dependency to the build. You can also manually add to your build:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut:micronaut-http-client")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-http-client&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</p>
</div>
<div class="sect3">
<h4 id="_an_example_http_client">An Example HTTP Client</h4>
<div class="paragraph">
<p>To create a picocli <code>Command</code> you create a class with fields annotated with <code>@Option</code> or <code>@Parameters</code> to capture the values of the command line options or positional parameters, respectively.</p>
</div>
<div class="paragraph">
<p>For example the following is a picocli <code>@Command</code> that wraps around the GitHub API:</p>
</div>
<div class="listingblock">
<div class="title">Example picocli command with injected HTTP client</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package example;

import io.micronaut.configuration.picocli.PicocliRunner;
import io.micronaut.context.ApplicationContext;
import io.micronaut.http.client.annotation.*;
import io.micronaut.http.client.*;
import io.reactivex.*;

import static io.micronaut.http.HttpRequest.*;

import picocli.CommandLine;
import picocli.CommandLine.Command;
import picocli.CommandLine.Option;
import picocli.CommandLine.Parameters;

import java.util.*;
import javax.inject.Inject;

@Command(name = "git-star", header = {
        "@|green       _ _      _             |@", <i class="conum" data-value="1"></i><b>(1)</b>
        "@|green  __ _(_) |_ __| |_ __ _ _ _  |@",
        "@|green / _` | |  _(_-&lt;  _/ _` | '_| |@",
        "@|green \\__, |_|\\__/__/\\__\\__,_|_|   |@",
        "@|green |___/                        |@"},
        description = "Shows GitHub stars for a project",
        mixinStandardHelpOptions = true, version = "git-star 0.1") <i class="conum" data-value="2"></i><b>(2)</b>
public class GitStarCommand implements Runnable {

    @Client("https://api.github.com")
    @Inject RxHttpClient client; <i class="conum" data-value="3"></i><b>(3)</b>

    @Option(names = {"-v", "--verbose"}, description = "Shows some project details")
    boolean verbose;

    @Parameters(description = {"One or more GitHub slugs (comma separated) to show stargazers for.",
                "  Default: ${DEFAULT-VALUE}"}, split = ",", paramLabel = "&lt;owner/repo&gt;") <i class="conum" data-value="4"></i><b>(4)</b>
    List&lt;String&gt; githubSlugs = Arrays.asList("micronaut-projects/micronaut-core", "remkop/picocli");

    public static void main(String[] args) {
        int exitCode = PicocliRunner.execute(GitStarCommand.class, args);
        System.exit(exitCode);
    }

    public void run() { <i class="conum" data-value="5"></i><b>(5)</b>
        for (String slug : githubSlugs) {
            Map m = client.retrieve(
                    GET("/repos/" + slug).header("User-Agent", "remkop-picocli"),
                    Map.class).blockingFirst();
            System.out.printf("%s has %s stars%n", slug, m.get("watchers"));

            if (verbose) {
                String msg = "Description: %s%nLicense: %s%nForks: %s%nOpen issues: %s%n%n";
                System.out.printf(msg, m.get("description"),
                                ((Map) m.get("license")).get("name"),
                                m.get("forks"), m.get("open_issues"));
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Headers, footers and descriptions can be multi-line. You can embed ANSI styled text anywhere with the <code>@|STYLE1[,STYLE2]…​ text|@</code> <a href="https://picocli.info/#_usage_help_with_styles_and_colors">markup notation</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add version information to display when the user requests this with <code>--version</code>. This can also be supplied dynamically, e.g. from the <a href="https://github.com/remkop/picocli/blob/master/examples/src/main/java/picocli/examples/VersionProviderDemo2.java">manifest file</a> or a build-generated version <a href="https://github.com/remkop/picocli/blob/master/examples/src/main/java/picocli/examples/VersionProviderDemo1.java">properties file</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Inject a HTTP client. In this case, hard-coded to the GitHub API endpoint.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>A positional parameter that lets the user select one or more GitHub projects</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The business logic: display information for each project the user requested.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The usage help message generated for this command looks like this:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../img/picocli-example.png" alt="picocli example"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subcommands">Subcommands</h3>
<div class="paragraph">
<p>If your service has a lot of functionality, a common pattern is to have subcommands to control different areas of the service.
To allow Micronaut to inject services and resources correctly into the subcommands,
make sure to obtain subcommand instances from the <code>ApplicationContext</code>, instead of instantiating them directly.</p>
</div>
<div class="paragraph">
<p>The easiest way to do this is to declare the subcommands on the top-level command, like this:</p>
</div>
<div class="listingblock">
<div class="title">A top-level command with subcommands</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Command(name = "topcmd", subcommands = {SubCmd1.class, SubCmd2.class}) <i class="conum" data-value="1"></i><b>(1)</b>
class TopCommand implements Callable&lt;Object&gt; { <i class="conum" data-value="2"></i><b>(2)</b>

    public static void main(String[] args) {
        PicocliRunner.execute(TopCommand.class, args); <i class="conum" data-value="3"></i><b>(3)</b>
    }
    //...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The top-level command has two subcommands, <code>SubCmd1</code> and <code>SubCmd2</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Let all commands in the hierarchy implement <code>Runnable</code> or <code>Callable</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Start the application with <code>PicocliRunner</code>. This creates an <code>ApplicationContext</code> that instantiates the commands and performs the dependency injection.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_picocli">Customizing Picocli</h3>
<div class="paragraph">
<p>Occasionally you may want to set parser options or otherwise customize picocli behavior.
This can easily be done via the setter methods on the picocli <code>CommandLine</code> object, but the <code>PicocliRunner</code> does not expose that object.</p>
</div>
<div class="paragraph">
<p>In such cases, you may want to invoke picocli directly instead of using the <code>PicocliRunner</code>.
The code below demonstrates how to do this:</p>
</div>
<div class="listingblock">
<div class="title">Example of customizing the picocli parser before invoking a command</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.micronaut.configuration.picocli.MicronautFactory;
import io.micronaut.context.ApplicationContext;
import io.micronaut.context.env.Environment;
import picocli.CommandLine;
import picocli.CommandLine.*;
import java.util.concurrent.Callable;

@Command(name = "configuration-example")
class ConfigDemo implements Callable&lt;Object&gt; {

    private static int execute(Class&lt;?&gt; clazz, String[] args) {
        try (ApplicationContext context = ApplicationContext.build(
                clazz, Environment.CLI).start()) { <i class="conum" data-value="1"></i><b>(1)</b>

            return new CommandLine(clazz, new MicronautFactory(context)). <i class="conum" data-value="2"></i><b>(2)</b>
                 setCaseInsensitiveEnumValuesAllowed(true). <i class="conum" data-value="3"></i><b>(3)</b>
                 setUsageHelpAutoWidth(true). <i class="conum" data-value="4"></i><b>(4)</b>
                 execute(args); <i class="conum" data-value="5"></i><b>(5)</b>
        }
    }

    public static void main(String[] args) {
        int exitCode = execute(ConfigDemo.class, args);
        System.exit(exitCode); <i class="conum" data-value="6"></i><b>(6)</b>
    }
    // ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instantiate a new <code>ApplicationContext</code> for the <code>CLI</code> environment, in a try-with-resources statements, so that the context is automatically closed before the method returns.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Pass a <code>MicronautFactory</code> with the application context to the picocli <code>CommandLine</code> constructor. This enables dependencies to be injected into the command and subcommands.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>An example of configuring the picocli command line parser.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>An example of configuring the picocli usage help message.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Execute the command and return the result (this closes the application context).</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Optionally call <code>System.exit</code> with the returned exit code.</td>
</tr>
</table>
</div>
</div>

    </div>
</div>

<script type="text/javascript">

</script>
</body>
</html>